<%
  ol_attrs = {class: 'form'}
  ol_attrs[:id] = subsection_id unless local_assigns[:subsection_id].nil?
  ol_attrs[:style] = 'display: none;' if columns.collapsed
%>
<%= as_element :field_search_fields_container, **ol_attrs do %>
  <% visibles, hiddens = visibles_and_hiddens(active_scaffold_config.field_search, columns) %>
  <% visibles.each do |column| -%>
    <%= render_field_search_column(column, @record) %>
  <% end -%>
  <% unless hiddens.empty?  -%>
    <%
      @hidden_section ||= ActiveScaffold::DataStructures::ActionColumns.new.tap do |group|
        group.label = :optional_attributes
        group.collapsed = true
      end
    %>
    <%= as_element :field_search_subsection do %>
      <%= render_subsection(@hidden_section, @record, nil, :field_search, subsection_id: sub_section_id(sub_section: 'further_options')) do |further_options_id| %>
        <%= as_element :field_search_fields_container, id: further_options_id, class: 'form', style: 'display:none;' do %>
          <% hiddens.each do |column| -%>
            <%= render_field_search_column(column, @record) %>
          <% end -%>
        <% end %>
      <% end %>
    <% end %>
  <% end -%>
<% end -%>
